<!DOCTYPE html>

<html lang="pt-BR">

<head>

Â  Â  <meta charset="UTF-8"/>

Â  Â  <title>Festa da MaitÃª - Admin</title>

Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1"/>

Â  Â  <link rel="preconnect" href="https://fonts.googleapis.com">

Â  Â  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

Â  Â  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

Â  Â  <style>

Â  Â  Â  Â  :root {

Â  Â  Â  Â  Â  Â  --rosa: #d63384;

Â  Â  Â  Â  Â  Â  --rosa-escuro: #ad2a6b;

Â  Â  Â  Â  Â  Â  --verde: #28a745;

Â  Â  Â  Â  Â  Â  --cinza-borda: #dcdcdc;

Â  Â  Â  Â  Â  Â  --bg-grad: linear-gradient(135deg, #ffe0f0, #ffc4e1);

Â  Â  Â  Â  Â  Â  --card-bg: #fff;

Â  Â  Â  Â  Â  Â  --radius-card: 18px;

Â  Â  Â  Â  Â  Â  --radius-btn: 8px;

Â  Â  Â  Â  Â  Â  --poppins: 'Poppins', sans-serif;

Â  Â  Â  Â  }

Â  Â  Â  Â  body {

Â  Â  Â  Â  Â  Â  margin: 0;

Â  Â  Â  Â  Â  Â  font-family: var(--poppins);

Â  Â  Â  Â  Â  Â  background: var(--bg-grad);

Â  Â  Â  Â  Â  Â  min-height: 100vh;

Â  Â  Â  Â  Â  Â  color: #333;

Â  Â  Â  Â  }

Â  Â  Â  Â  .center-wrap {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-direction: column;

Â  Â  Â  Â  Â  Â  align-items: center;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  min-height: 100vh;

Â  Â  Â  Â  Â  Â  padding: 16px;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  }

Â  Â  Â  Â  .card {

Â  Â  Â  Â  Â  Â  background: var(--card-bg);

Â  Â  Â  Â  Â  Â  padding: 32px 28px;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-card);

Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 24px rgba(0,0,0,0.1);

Â  Â  Â  Â  Â  Â  max-width: 500px;

Â  Â  Â  Â  Â  Â  margin: 16px;

Â  Â  Â  Â  Â  Â  text-align: left;

Â  Â  Â  Â  }

Â  Â  Â  Â  h1, h2, h3 {

Â  Â  Â  Â  Â  Â  margin-top: 0;

Â  Â  Â  Â  Â  Â  font-weight: 600;

Â  Â  Â  Â  }

Â  Â  Â  Â  h1 { color: var(--rosa); font-size: 1.9rem; text-align: center; }

Â  Â  Â  Â  h2 { color: var(--rosa); font-size: 1.4rem; text-align: center; }

Â  Â  Â  Â  h3 { color: var(--rosa); font-size: 1.1rem; margin-bottom: 8px; }

Â  Â  Â  Â  p { line-height: 1.4; margin: 0 0 1em; }

Â  Â  Â  Â  .btn {

Â  Â  Â  Â  Â  Â  background-color: var(--rosa);

Â  Â  Â  Â  Â  Â  color: white;

Â  Â  Â  Â  Â  Â  padding: 12px 20px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  font-size: 16px;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  margin-top: 16px;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn:hover { background-color: var(--rosa-escuro); }

Â  Â  Â  Â  .form-group {

Â  Â  Â  Â  Â  Â  margin-bottom: 1rem;

Â  Â  Â  Â  }

Â  Â  Â  Â  label {

Â  Â  Â  Â  Â  Â  display: block;

Â  Â  Â  Â  Â  Â  font-weight: 600;

Â  Â  Â  Â  Â  Â  margin-bottom: 0.5rem;

Â  Â  Â  Â  }

Â  Â  Â  Â  input {

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  padding: 0.75rem;

Â  Â  Â  Â  Â  Â  border: 1px solid var(--cinza-borda);

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  box-sizing: border-box;

Â  Â  Â  Â  }

Â  Â  Â  Â  #sugestaoPresente {

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  min-height: 120px;

Â  Â  Â  Â  Â  Â  padding: 0.75rem;

Â  Â  Â  Â  Â  Â  border: 1px solid var(--cinza-borda);

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  box-sizing: border-box;

Â  Â  Â  Â  Â  Â  background: #f8f9fa;

Â  Â  Â  Â  Â  Â  line-height: 1.4;

Â  Â  Â  Â  Â  Â  text-align: left;

Â  Â  Â  Â  Â  Â  cursor: text;

Â  Â  Â  Â  }

Â  Â  Â  Â  .text-center {

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  }

Â  Â  Â  Â  /* Admin specific styles */

Â  Â  Â  Â  #adminArea {

Â  Â  Â  Â  Â  Â  display: none; /* Hidden by default, shown after login */

Â  Â  Â  Â  Â  Â  position: fixed;

Â  Â  Â  Â  Â  Â  inset: 0;

Â  Â  Â  Â  Â  Â  background: #fff8fc;

Â  Â  Â  Â  Â  Â  z-index: 999;

Â  Â  Â  Â  Â  Â  padding: 40px 16px 80px;

Â  Â  Â  Â  Â  Â  overflow-y: auto;

Â  Â  Â  Â  }

Â  Â  Â  Â  .admin-inner {

Â  Â  Â  Â  Â  Â  max-width: 700px;

Â  Â  Â  Â  Â  Â  margin: 0 auto;

Â  Â  Â  Â  }

Â  Â  Â  Â  /* Removed .closeBtn and #voltarBtn styles */

Â  Â  Â  Â  .admin-actions {

Â  Â  Â  Â  Â  Â  margin-top: 16px;

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  gap: 8px;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  }

Â  Â  Â  Â  .admin-btn {

Â  Â  Â  Â  Â  Â  padding: 8px 14px;

Â  Â  Â  Â  Â  Â  font-size: 14px;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  }

Â  Â  Â  Â  .admin-btn.add { background: var(--rosa); color: #fff; }

Â  Â  Â  Â  .admin-btn.save { background: #007bff; color: #fff; } /* Novo estilo para o botÃ£o salvar */

Â  Â  Â  Â  .admin-btn.mass { background: var(--verde); color: #fff; }

Â  Â  Â  Â  .admin-btn.mass:hover {filter: brightness (0.9); }

Â  Â  Â  Â  #familiasContainer {

Â  Â  Â  Â  Â  Â  margin-top: 24px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .familyBox {

Â  Â  Â  Â  Â  Â  border: 1px dashed var(--cinza-borda);

Â  Â  Â  Â  Â  Â  padding: 16px;

Â  Â  Â  Â  Â  Â  margin-bottom: 12px;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-card);

Â  Â  Â  Â  Â  Â  background: #ffffff;

Â  Â  Â  Â  Â  Â  position: relative;

Â  Â  Â  Â  }

Â  Â  Â  Â  .familyBox strong {

Â  Â  Â  Â  Â  Â  font-size: 1.1rem;

Â  Â  Â  Â  Â  Â  color: var(--rosa-escuro);

Â  Â  Â  Â  }

Â  Â  Â  Â  .familyBox p {

Â  Â  Â  Â  Â  Â  margin: 4px 0;

Â  Â  Â  Â  Â  Â  font-size: 0.95rem;

Â  Â  Â  Â  }

Â  Â  Â  Â  .fam-actions {

Â  Â  Â  Â  Â  Â  margin-top: 8px;

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  gap: 8px;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  }

Â  Â  Â  Â  .fam-btn {

Â  Â  Â  Â  Â  Â  padding: 6px 12px;

Â  Â  Â  Â  Â  Â  font-size: 13px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  }

Â  Â  Â  Â  .fam-send { background: var(--verde); color: #fff; }

Â  Â  Â  Â  .fam-edit { background: #ffc107; color: #000; }

Â  Â  Â  Â  .fam-delete { background: #dc3545; color: #fff; }

Â  Â  Â  Â  .fam-lembrete { background: #007bff; color: #fff; } /* Adicionado estilo para Lembrete */

Â  Â  Â  Â  .fam-btn:hover {filter: brightness(0.9); }

Â  Â  Â  Â  .data-info {

Â  Â  Â  Â  Â  Â  margin-top: 12px;

Â  Â  Â  Â  Â  Â  padding: 10px;

Â  Â  Â  Â  Â  Â  background: rgba(40, 167, 69, 0.1);

Â  Â  Â  Â  Â  Â  border-left: 4px solid #28a745;

Â  Â  Â  Â  Â  Â  border-radius: 4px;

Â  Â  Â  Â  Â  Â  font-size: 0.9rem;

Â  Â  Â  Â  }

Â  Â  Â  Â  .data-info.vencido {

Â  Â  Â  Â  Â  Â  background: rgba(220, 53, 69, 0.1);

Â  Â  Â  Â  Â  Â  border-left-color: #dc3545;

Â  Â  Â  Â  }

Â  Â  Â  Â  .data-info p {

Â  Â  Â  Â  Â  Â  margin: 4px 0;

Â  Â  Â  Â  Â  Â  color: #495057;

Â  Â  Â  Â  }

Â  Â  Â  Â  .data-info.vencido p {

Â  Â  Â  Â  Â  Â  color: #721c24;

Â  Â  Â  Â  }

Â  Â  Â  Â  #editModal {

Â  Â  Â  Â  Â  Â  display: none;

Â  Â  Â  Â  Â  Â  position: fixed;

Â  Â  Â  Â  Â  Â  inset: 0;

Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.45);

Â  Â  Â  Â  Â  Â  z-index: 1001;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  align-items: center;

Â  Â  Â  Â  Â  Â  padding: 16px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .edit-content {

Â  Â  Â  Â  Â  Â  background: #fff;

Â  Â  Â  Â  Â  Â  max-width: 420px;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  padding: 24px;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-card);

Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 16px rgba(0,0,0,0.3);

Â  Â  Â  Â  Â  Â  position: relative;

Â  Â  Â  Â  }

Â  Â  Â  Â  .edit-close {

Â  Â  Â  Â  Â  Â  position: absolute;

Â  Â  Â  Â  Â  Â  top: 8px;

Â  Â  Â  Â  Â  Â  right: 12px;

Â  Â  Â  Â  Â  Â  background: transparent;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  font-size: 24px;

Â  Â  Â  Â  Â  Â  color: var(--rosa);

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  }

Â  Â  Â  Â  .edit-save {

Â  Â  Â  Â  Â  Â  margin-top: 16px;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  background: var(--rosa);

Â  Â  Â  Â  Â  Â  color: #fff;

Â  Â  Â  Â  Â  Â  padding: 10px;

Â  Â  Â  Â  Â  Â  font-size: 16px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  border-radius: var(--radius-btn);

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  }

Â  Â  Â  Â  .edit-save:hover { background: var(--rosa-escuro); }

Â  Â  Â  Â  .login-card {

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  }

Â  Â  Â  Â  .error-message {

Â  Â  Â  Â  Â  Â  color: #dc3545;

Â  Â  Â  Â  Â  Â  margin-top: 10px;

Â  Â  Â  Â  Â  Â  font-size: 0.9rem;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  }

Â  Â  Â  Â  @media (max-width:480px) {

Â  Â  Â  Â  Â  Â  .card { padding: 24px 20px; }

Â  Â  Â  Â  Â  Â  h1 { font-size: 1.6rem; }

Â  Â  Â  Â  Â  Â  .btn { width: 100%; }

Â  Â  Â  Â  }

Â  Â  </style>

</head>

<body>



<div id="loginView" class="center-wrap">

Â  Â  <div class="card login-card">

Â  Â  Â  Â  <h1>Acesso Administrativo</h1>

Â  Â  Â  Â  <p>Por favor, insira a senha para acessar a Ã¡rea de gerenciamento.</p>

Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  <label for="adminPassword">Senha:</label>

Â  Â  Â  Â  Â  Â  <input type="password" id="adminPassword" placeholder="Digite a senha">

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button id="loginSubmitBtn" class="btn" type="button">Entrar</button>

Â  Â  Â  Â  <p id="loginErrorMessage" class="error-message" hidden>Senha incorreta. Tente novamente.</p>

Â  Â  </div>

</div>



<div id="adminArea" hidden>

Â  Â  <div class="admin-inner">

Â  Â  Â  Â  <h2>Gerenciamento de FamÃ­lias</h2>

Â  Â  Â  Â  <div class="admin-form">

Â  Â  Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  Â  Â  <label for="responsavel">ResponsÃ¡vel (Ex: Sueli)</label>

Â  Â  Â  Â  Â  Â  Â  Â  <input id="responsavel" placeholder="ResponsÃ¡vel" required />

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  Â  Â  <label for="membros">Membros (Ex: Sueli, Adilson, Eduardo)</label>

Â  Â  Â  Â  Â  Â  Â  Â  <input id="membros" placeholder="Membros separados por vÃ­rgula" required />

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  Â  Â  <label for="telefone">Telefone com DDD (somente nÃºmeros)</label>

Â  Â  Â  Â  Â  Â  Â  Â  <input id="telefone" type="tel" placeholder="Ex: 11999999999" required />

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  Â  Â  <label for="sugestaoPresente">SugestÃ£o de Presente</label>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="sugestaoPresente" contenteditable="true" spellcheck="false" placeholder="Digite a sugestÃ£o de presente..."></div>

Â  Â  Â  Â  Â  Â  Â  Â  <button class="admin-btn save" type="button" id="saveSugestaoBtn">Salvar SugestÃ£o</button>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="admin-actions">

Â  Â  Â  Â  Â  Â  Â  Â  <button class="admin-btn add" type="button" id="addFamiliaBtn">Adicionar FamÃ­lia</button>

Â  Â  Â  Â  Â  Â  Â  Â  <button class="admin-btn mass" type="button" id="enviarTodosBtn">Enviar Todos</button>

Â  Â  Â  Â  Â  Â  Â  Â  <button class="admin-btn mass" type="button" id="exportBtn" title="Exportar em CSV">Exportar CSV</button>

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="familiasContainer"></div>

Â  Â  </div>

</div>



<div id="editModal">

Â  Â  <div class="edit-content">

Â  Â  Â  Â  <button class="edit-close" type="button" aria-label="Fechar ediÃ§Ã£o">&times;</button>

Â  Â  Â  Â  <h3>Editar FamÃ­lia</h3>

Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  <label for="editResponsavel">Responsavel</label>

Â  Â  Â  Â  Â  Â  <input id="editResponsavel" />

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  <label for="editMembros">Membros</label>

Â  Â  Â  Â  Â  Â  <input id="editMembros" />

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">

Â  Â  Â  Â  Â  Â  <label for="editTelefone">Telefone</label>

Â  Â  Â  Â  Â  Â  <input id="editTelefone" />

Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="edit-save" type="button" id="editSaveBtn">Salvar AlteraÃ§Ãµes</button>

Â  Â  </div>

</div>



<script>

Â  Â  const $ = (id) => document.getElementById(id);

Â  Â  const STORAGE_KEY = 'conviteMaite_familias_v1';

Â  Â  const SUGESTAO_KEY = 'conviteMaite_sugestao_v1';

Â  Â  const ADMIN_PASSWORD = 'maite'; // TROQUE ESTA SENHA!



Â  Â  let familias = [];

Â  Â  let sugestaoPresente = `

Â  Â  Â  Â  *SugestÃ£o de Presente*

Â  Â  Â  Â  <br><br>

Â  Â  Â  Â  Roupa tamanho 1

Â  Â  Â  Â  <br>

Â  Â  Â  Â  Sapato nÂº 17/18

Â  Â  Â  Â  <br>

Â  Â  Â  Â  Gosta de brinquedos coloridos

Â  Â  Â  Â  <br><br>

Â  Â  Â  Â  _(Essas sÃ£o apenas sugestÃµes! Sua presenÃ§a Ã© o melhor presente.)_

Â  Â  `.trim().replace(/\n/g, '');



Â  Â  function buildInviteLink(familiaName, membrosList) {

Â  Â  Â  Â  const currentUrl = window.location.href;

Â  Â  Â  Â  const parts = currentUrl.split('/');

Â  Â  Â  Â  let baseUrl;



Â  Â  Â  Â  const projectIndex = parts.indexOf('convite-maite');

Â  Â  Â  Â  if (projectIndex > -1) {

Â  Â  Â  Â  Â  Â  baseUrl = parts.slice(0, projectIndex + 1).join('/') + '/';

Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  const path = window.location.pathname;

Â  Â  Â  Â  Â  Â  const lastSlash = path.lastIndexOf('/');

Â  Â  Â  Â  Â  Â  if (lastSlash > -1) {

Â  Â  Â  Â  Â  Â  Â  Â  baseUrl = window.location.origin + path.substring(0, lastSlash) + '/';

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  baseUrl = window.location.origin + '/';

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  return `${baseUrl}index.html?familia=${encodeURIComponent(familiaName)}&membros=${encodeURIComponent(membrosList)}`;

Â  Â  }



Â  Â  function sanitizePhone(raw) {

Â  Â  Â  Â  const digits = raw.replace(/\D+/g, '');

Â  Â  Â  Â  return digits.length >= 10 ? digits : null;

Â  Â  }



Â  Â  function adicionarDiasUteis(data, diasUteis) {

Â  Â  Â  Â  const resultado = new Date(data);

Â  Â  Â  Â  let diasAdicionados = 0;

Â  Â  Â  Â  while (diasAdicionados < diasUteis) {

Â  Â  Â  Â  Â  Â  resultado.setDate(resultado.getDate() + 1);

Â  Â  Â  Â  Â  Â  if (resultado.getDay() !== 0 && resultado.getDay() !== 6) { // 0 = Sunday, 6 = Saturday

Â  Â  Â  Â  Â  Â  Â  Â  diasAdicionados++;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  Â  Â  return resultado;

Â  Â  }



Â  Â  function formatarData(data) {

Â  Â  Â  Â  return data.toLocaleDateString('pt-BR', {

Â  Â  Â  Â  Â  Â  day: '2-digit',

Â  Â  Â  Â  Â  Â  month: '2-digit',

Â  Â  Â  Â  Â  Â  year: 'numeric'

Â  Â  Â  Â  });

Â  Â  }



Â  Â  document.addEventListener('DOMContentLoaded', () => {

Â  Â  Â  Â  function loadFromStorage() {

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  const raw = localStorage.getItem(STORAGE_KEY);

Â  Â  Â  Â  Â  Â  Â  Â  if (raw) familias = JSON.parse(raw);

Â  Â  Â  Â  Â  Â  Â  Â  const sugestaoRaw = localStorage.getItem(SUGESTAO_KEY);

Â  Â  Â  Â  Â  Â  Â  Â  if (sugestaoRaw) sugestaoPresente = sugestaoRaw;

Â  Â  Â  Â  Â  Â  Â  Â  if ($('sugestaoPresente')) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('sugestaoPresente').innerHTML = sugestaoPresente;

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  } catch (e) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error('Erro ao carregar storage', e);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  function saveToStorage() {

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem(STORAGE_KEY, JSON.stringify(familias));

Â  Â  Â  Â  Â  Â  } catch (e) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error('Erro ao salvar storage', e);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  function saveSugestaoPresente() {

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  sugestaoPresente = $('sugestaoPresente').innerHTML;

Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem(SUGESTAO_KEY, sugestaoPresente);

Â  Â  Â  Â  Â  Â  Â  Â  alert('SugestÃ£o de presente salva e atualizada nas pÃ¡ginas de convite!');

Â  Â  Â  Â  Â  Â  } catch(e) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error('Erro ao salvar sugestÃ£o', e);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  function renderFamilias() {

Â  Â  Â  Â  Â  Â  const container = $('familiasContainer');

Â  Â  Â  Â  Â  Â  if (!container) return;



Â  Â  Â  Â  Â  Â  container.innerHTML = '';

Â  Â  Â  Â  Â  Â  if (!familias.length) {

Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = '<p>Nenhuma famÃ­lia cadastrada ainda.</p>';

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  familias.forEach(fam => {

Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('div');

Â  Â  Â  Â  Â  Â  Â  Â  div.className = 'familyBox';

Â  Â  Â  Â  Â  Â  Â  Â  const link = buildInviteLink(fam.responsavel, fam.membros);



Â  Â  Â  Â  Â  Â  Â  Â  let dataInfo = '';

Â  Â  Â  Â  Â  Â  Â  Â  if (fam.dataEnvio && fam.dataVencimento) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const hoje = new Date();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const vencimento = new Date(fam.dataVencimento);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const vencido = hoje > vencimento;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dataInfo = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-info ${vencido ? 'vencido' : ''}">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>Enviado em:</strong> ${formatarData(new Date(fam.dataEnvio))}</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>Vence em:</strong> ${formatarData(vencimento)} ${vencido ? '(VENCIDO)' : ''}</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>${fam.responsavel}</strong>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Membros: ${fam.membros}</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Tel: ${fam.telefone}</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size:12px;word-break:break-all;">Link: <a href="${link}" target="_blank">${link}</a></p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${dataInfo}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="fam-actions">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="fam-btn fam-send" type="button" data-id="${fam.id}">Encaminhar</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="fam-btn fam-lembrete" type="button" data-id="${fam.id}">Lembrete</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="fam-btn fam-edit" type="button" data-id="${fam.id}">Editar</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="fam-btn fam-delete" type="button" data-id="${fam.id}">Excluir</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(div);

Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  }



Â  Â  Â  Â  function showView(viewName) {

Â  Â  Â  Â  Â  Â  const views = {

Â  Â  Â  Â  Â  Â  Â  Â  login: $('loginView'),

Â  Â  Â  Â  Â  Â  Â  Â  admin: $('adminArea')

Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  for (const view in views) {

Â  Â  Â  Â  Â  Â  Â  Â  if (views[view]) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  views[view].hidden = true;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (views[view].style) views[view].style.display = 'none';

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (views[viewName]) {

Â  Â  Â  Â  Â  Â  Â  Â  views[viewName].hidden = false;

Â  Â  Â  Â  Â  Â  Â  Â  if (views[viewName].style) views[viewName].style.display = (viewName === 'admin' ? 'block' : 'flex');

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  let editId = null;

Â  Â  Â  Â  function openEditModal(id) {

Â  Â  Â  Â  Â  Â  const fam = familias.find(f => f.id === id);

Â  Â  Â  Â  Â  Â  if (!fam) return;



Â  Â  Â  Â  Â  Â  editId = id;

Â  Â  Â  Â  Â  Â  $('editResponsavel').value = fam.responsavel;

Â  Â  Â  Â  Â  Â  $('editMembros').value = fam.membros;

Â  Â  Â  Â  Â  Â  $('editTelefone').value = fam.telefone;

Â  Â  Â  Â  Â  Â  $('editModal').style.display = 'flex';

Â  Â  Â  Â  }



Â  Â  Â  Â  function closeEditModal() {

Â  Â  Â  Â  Â  Â  editId = null;

Â  Â  Â  Â  Â  Â  $('editModal').style.display = 'none';

Â  Â  Â  Â  }



Â  Â  Â  Â  function handleLogin() {

Â  Â  Â  Â  Â  Â  const passwordInput = $('adminPassword');

Â  Â  Â  Â  Â  Â  const errorMessage = $('loginErrorMessage');

Â  Â  Â  Â  Â  Â  if (!passwordInput || !errorMessage) return;



Â  Â  Â  Â  Â  Â  const password = passwordInput.value;

Â  Â  Â  Â  Â  Â  if (password === ADMIN_PASSWORD) {

Â  Â  Â  Â  Â  Â  Â  Â  showView('admin');

Â  Â  Â  Â  Â  Â  Â  Â  errorMessage.hidden = true;

Â  Â  Â  Â  Â  Â  Â  Â  passwordInput.value = '';

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  errorMessage.hidden = false;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  function handleAddFamilia() {

Â  Â  Â  Â  Â  Â  const responsavelInput = $('responsavel');

Â  Â  Â  Â  Â  Â  const membrosInput = $('membros');

Â  Â  Â  Â  Â  Â  const telefoneInput = $('telefone');



Â  Â  Â  Â  Â  Â  if (!responsavelInput || !membrosInput || !telefoneInput) return;



Â  Â  Â  Â  Â  Â  const responsavel = responsavelInput.value.trim();

Â  Â  Â  Â  Â  Â  const membros = membrosInput.value.trim();

Â  Â  Â  Â  Â  Â  const telefone = sanitizePhone(telefoneInput.value.trim());



Â  Â  Â  Â  Â  Â  if (!responsavel || !membros || !telefone) {

Â  Â  Â  Â  Â  Â  Â  Â  alert('Preencha todos os campos corretamente (telefone com DDD, sÃ³ nÃºmeros).');

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  const id = crypto.randomUUID ? crypto.randomUUID() : String(Date.now() + Math.random());

Â  Â  Â  Â  Â  Â  familias.push({ id, responsavel, membros, telefone });

Â  Â  Â  Â  Â  Â  saveToStorage();

Â  Â  Â  Â  Â  Â  renderFamilias();



Â  Â  Â  Â  Â  Â  responsavelInput.value = '';

Â  Â  Â  Â  Â  Â  membrosInput.value = '';

Â  Â  Â  Â  Â  Â  telefoneInput.value = '';

Â  Â  Â  Â  }



Â  Â  Â  Â  function handleSaveEditFamilia() {

Â  Â  Â  Â  Â  Â  if (!editId) return;

Â  Â  Â  Â  Â  Â  const fam = familias.find(f => f.id === editId);

Â  Â  Â  Â  Â  Â  if (!fam) return;



Â  Â  Â  Â  Â  Â  const responsavelInput = $('editResponsavel');

Â  Â  Â  Â  Â  Â  const membrosInput = $('editMembros');

Â  Â  Â  Â  Â  Â  const telefoneInput = $('editTelefone');



Â  Â  Â  Â  Â  Â  if (!responsavelInput || !membrosInput || !telefoneInput) return;



Â  Â  Â  Â  Â  Â  const responsavel = responsavelInput.value.trim();

Â  Â  Â  Â  Â  Â  const membros = membrosInput.value.trim();

Â  Â  Â  Â  Â  Â  const telefone = sanitizePhone(telefoneInput.value.trim());

Â  Â  Â  Â  Â  Â  if (!responsavel || !membros || !telefone) {

Â  Â  Â  Â  Â  Â  Â  Â  alert('Preencha todos os campos corretamente (telefone com DDD, sÃ³ nÃºmeros).');

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  fam.responsavel = responsavel;

Â  Â  Â  Â  Â  Â  fam.membros = membros;

Â  Â  Â  Â  Â  Â  fam.telefone = telefone;



Â  Â  Â  Â  Â  Â  saveToStorage();

Â  Â  Â  Â  Â  Â  renderFamilias();

Â  Â  Â  Â  Â  Â  closeEditModal();

Â  Â  Â  Â  }



Â  Â  Â  Â  function handleDeleteFamilia(id) {

Â  Â  Â  Â  Â  Â  const fam = familias.find(f => f.id === id);

Â  Â  Â  Â  Â  Â  if (!fam) return;

Â  Â  Â  Â  Â  Â  if (!confirm(`Tem certeza que deseja excluir a famÃ­lia de ${fam.responsavel}?`)) return;



Â  Â  Â  Â  Â  Â  familias = familias.filter(f => f.id !== id);

Â  Â  Â  Â  Â  Â  saveToStorage();

Â  Â  Â  Â  Â  Â  renderFamilias();

Â  Â  Â  Â  }



Â  Â  Â  Â  function enviarLinkWhatsApp(fam) {

Â  Â  Â  Â  Â  Â  const link = buildInviteLink(fam.responsavel, fam.membros);

Â  Â  Â  Â  Â  Â  const msg = `ðŸŒŸâœ¨ OlÃ¡, meus amiguinhos e familiares encantados! âœ¨ðŸŒŸ



O meu aniversÃ¡rio estÃ¡ se aproximando, e eu estou radiante de alegria! ðŸ¥³ðŸŽ‚



Quero muito que vocÃª faÃ§a parte dessa festinha dos sonhos, cheia de amor, magia e smiles! ðŸŒˆðŸ§šâ€â™€ï¸

A sua presenÃ§a Ã© um presentÃ£o para mim! Mas, se nÃ£o puder vir, nÃ£o tem problemaâ€¦ vamos entender com muito carinho. ðŸ’Œ



Como nossa lista de convidados Ã© bem especial e limitada, Ã© muito importante que cada pessoa confirme a presenÃ§a individualmente.



Assim conseguimos organizar tudo com muito amor e preparar um dia inesquecÃ­vel! ðŸŽ‰

ðŸ”” Importante:



A confirmaÃ§Ã£o deve ser feita em atÃ© 5 dias Ãºteis apÃ³s o envio deste convite mÃ¡gico.



Se nÃ£o recebermos sua resposta dentro do prazo, vamos entender como uma ausÃªncia â€” e abriremos espaÃ§o para outros convidados encantados. âœ¨

ðŸ“œ Os nomes confirmados serÃ£o entregues aos magos da assessoria do SalÃ£o KidÃ¡hora nesse prazo encantado!

ðŸ’– Para confirmar, basta clicar no link abaixo.

Com todo meu carinho de princesa,

MaitÃª ðŸ’•ðŸ‘‘ðŸŽˆ



ðŸ‘‡ Link de ConfirmaÃ§Ã£o:

${link}`;



Â  Â  Â  Â  Â  Â  const zap = `https://wa.me/55${fam.telefone}?text=${encodeURIComponent(msg)}`;

Â  Â  Â  Â  Â  Â  const win = window.open(zap, '_blank');

Â  Â  Â  Â  Â  Â  if (win && !win.closed) {

Â  Â  Â  Â  Â  Â  Â  Â  const agora = new Date();

Â  Â  Â  Â  Â  Â  Â  Â  const vencimento = adicionarDiasUteis(agora, 5); // 5 business days

Â  Â  Â  Â  Â  Â  Â  Â  fam.dataEnvio = agora.toISOString();

Â  Â  Â  Â  Â  Â  Â  Â  fam.dataVencimento = vencimento.toISOString();

Â  Â  Â  Â  Â  Â  Â  Â  saveToStorage();

Â  Â  Â  Â  Â  Â  Â  Â  renderFamilias();

Â  Â  Â  Â  Â  Â  Â  Â  alert(`Convite enviado! Prazo para resposta: ${formatarData(vencimento)}`);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  alert('NÃ£o consegui abrir o WhatsApp. Verifique se o navegador bloqueou pop-ups ou se o nÃºmero estÃ¡ correto.');

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  function enviarLembreteWhatsApp(fam) {
    const link = buildInviteLink(fam.responsavel, fam.membros); // Ã‰ importante ter o link aqui, caso contrÃ¡rio a variÃ¡vel 'link' no corpo da mensagem estarÃ¡ indefinida.
    const msg = `ðŸ©·âœ¨ OlÃ¡, amiguinhos e familiares encantados! âœ¨ðŸ©·

Estamos enviando esta mensagem com muito carinho porque o prazo de confirmaÃ§Ã£o da presenÃ§a na festinha mÃ¡gica da nossa MaitÃª termina amanhÃ£! ðŸŽ‚ðŸ¥³

Ainda nÃ£o recebemos sua resposta... e como a nossa lista de convidados Ã© limitada e especial, quem nÃ£o confirmar atÃ© o prazo serÃ¡ considerado como ausÃªncia, e o espaÃ§o serÃ¡ aberto para outro convidado encantado que estÃ¡ aguardando por uma vaga. ðŸŒŸ

ðŸ’« Importante:
A confirmaÃ§Ã£o deve ser feita individualmente pelo link enviado abaixo.
â›” NÃ£o serÃ¡ permitido confirmar e enviar outra pessoa no lugar, nem levar acompanhantes extras. A entrada sÃ³ serÃ¡ autorizada para os nomes confirmados antecipadamente na lista enviada Ã  assessoria do buffet Kidahora.

Se vocÃª nÃ£o puder comparecer, tudo bem tambÃ©m! SÃ³ pedimos que nos avise dentro do prazo, assim conseguimos organizar tudo com muito cuidado e magia ðŸ’–

Com muito amor e brilhinhos de felicidade,
FamÃ­lia da MaitÃª ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦âœ¨

ðŸ”— Link para confirmaÃ§Ã£o:
${link}`;

    const zap = `https://wa.me/55${fam.telefone}?text=${encodeURIComponent(msg)}`;
    const win = window.open(zap, '_blank');
    if (win && !win.closed) {
        alert(`Lembrete enviado para ${fam.responsavel}!`);
    } else {
        alert('NÃ£o consegui abrir o WhatsApp para enviar o lembrete. Verifique se o navegador bloqueou pop-ups ou se o nÃºmero estÃ¡ correto.');
    }
}





Â  Â  Â  Â  function exportCSV() {

Â  Â  Â  Â  Â  Â  if (!familias.length) {

Â  Â  Â  Â  Â  Â  Â  Â  alert('Nada para exportar.');

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const header = ['Responsavel', 'Membros', 'Telefone', 'Link'];

Â  Â  Â  Â  Â  Â  const rows = familias.map(f => {

Â  Â  Â  Â  Â  Â  Â  Â  const link = buildInviteLink(f.responsavel, f.membros);

Â  Â  Â  Â  Â  Â  Â  Â  return [

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `"${f.responsavel.replace(/"/g, '""')}"`,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `"${f.membros.replace(/"/g, '""')}"`,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `"${f.telefone}"`,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `"${link}"`

Â  Â  Â  Â  Â  Â  Â  Â  ].join(',');

Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const csv = [header.join(','), ...rows].join('\r\n');

Â  Â  Â  Â  Â  Â  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });

Â  Â  Â  Â  Â  Â  const url = URL.createObjectURL(blob);

Â  Â  Â  Â  Â  Â  const a = document.createElement('a');

Â  Â  Â  Â  Â  Â  a.href = url;

Â  Â  Â  Â  Â  Â  a.download = 'familias_convite_maite.csv';

Â  Â  Â  Â  Â  Â  document.body.appendChild(a);

Â  Â  Â  Â  Â  Â  a.click();

Â  Â  Â  Â  Â  Â  document.body.removeChild(a);

Â  Â  Â  Â  Â  Â  setTimeout(() => URL.revokeObjectURL(url), 1000);

Â  Â  Â  Â  }



Â  Â  Â  Â  loadFromStorage();

Â  Â  Â  Â  renderFamilias();

Â  Â  Â  Â  showView('login');



Â  Â  Â  Â  $('loginSubmitBtn').addEventListener('click', handleLogin);

Â  Â  Â  Â  $('adminPassword').addEventListener('keypress', (e) => {

Â  Â  Â  Â  Â  Â  if (e.key === 'Enter') handleLogin();

Â  Â  Â  Â  });

Â  Â  Â  Â  $('addFamiliaBtn').addEventListener('click', handleAddFamilia);

Â  Â  Â  Â  $('exportBtn').addEventListener('click', exportCSV);

Â  Â  Â  Â  $('enviarTodosBtn').addEventListener('click', () => {

Â  Â  Â  Â  Â  Â  alert('Esta funÃ§Ã£o nÃ£o estÃ¡ implementada nesta versÃ£o reestruturada, pois pode ser bloqueada por navegadores. Sugerimos enviar um a um para melhor controle.');

Â  Â  Â  Â  });

Â  Â  Â  Â  $('saveSugestaoBtn').addEventListener('click', saveSugestaoPresente);

Â  Â  Â  Â  $('familiasContainer').addEventListener('click', (e) => {

Â  Â  Â  Â  Â  Â  const id = e.target.getAttribute('data-id');

Â  Â  Â  Â  Â  Â  const fam = familias.find(f => f.id === id);



Â  Â  Â  Â  Â  Â  if (e.target.classList.contains('fam-send')) {

Â  Â  Â  Â  Â  Â  Â  Â  if (fam) enviarLinkWhatsApp(fam);

Â  Â  Â  Â  Â  Â  } else if (e.target.classList.contains('fam-lembrete')) {

Â  Â  Â  Â  Â  Â  Â  Â  if (fam) enviarLembreteWhatsApp(fam);

Â  Â  Â  Â  Â  Â  } else if (e.target.classList.contains('fam-edit')) {

Â  Â  Â  Â  Â  Â  Â  Â  openEditModal(id);

Â  Â  Â  Â  Â  Â  } else if (e.target.classList.contains('fam-delete')) {

Â  Â  Â  Â  Â  Â  Â  Â  handleDeleteFamilia(id);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });



Â  Â  Â  Â  $('editSaveBtn').addEventListener('click', handleSaveEditFamilia);

Â  Â  Â  Â  document.querySelector('#editModal .edit-close').addEventListener('click', closeEditModal);

Â  Â  Â  Â  $('editModal').addEventListener('click', (e) => {

Â  Â  Â  Â  Â  Â  if (e.target === $('editModal')) closeEditModal();

Â  Â  Â  Â  });

Â  Â  });

</script>

</body>

</html>
